<% layout('layouts/boilerplate') -%>

<div class="row">

  <div class="col-lg-3">
    <h3>Filter By:</h3>
    <form action="/posts" method="GET" id="post-filter-form">
    	<fieldset>
    		<legend id="condition-legend">Condition</legend>
    		<div class="form-check form-check-inline">
    		  <label class="form-check-label">
    		    <input class="form-check-input" type="checkbox" value="excellent" name="post[condition]"> Excellent
    		  </label>
    		</div>
    		<div class="form-check form-check-inline">
    		  <label class="form-check-label">
    		    <input class="form-check-input" type="checkbox" value="good" name="post[condition]"> Good
    		  </label>
    		</div>
    		<div class="form-check form-check-inline">
    		  <label class="form-check-label">
    		    <input class="form-check-input" type="checkbox" value="poor" name="post[condition]"> Poor
    		  </label>
    		</div>
    	</fieldset>
    	<div class="form-group">
	    	<label for="price">Price</label>
	    	<input type="number" class="form-control" id="price" name="post[price]" min="0" step="1" placeholder="Price">
	    </div>
    	<div class="form-group">
	    	<label for="location">Location</label>
	    	<input type="text" class="form-control" id="location" name="post[location]" placeholder="Address or Zipcode">
	    </div>
    	<div class="form-group">
	    	<label for="distance">Distance</label>
	    	<input type="number" class="form-control" id="distance" name="post[distance]" min="0" step="1" max="600" placeholder="Distance">
	    </div>

    	<input type="submit" class="btn btn-outline-primary btn-block mb-3" role="button" value="Go!">
    </form>

  </div> 
  <!-- /.col-lg-3 -->
	
	<div class="col-lg-9">
		<div id="index-map" class="mb-4 rounded"></div>

		<div class="row" id="posts-row">
			<% posts.forEach((post) => { %>
			<div class="col-lg-4 col-md-6 mb-4">
			  <div class="card h-100">
			    <a href="/posts/<%= post.id %>"><img class="card-img-top" src="<%= post.image %>" alt="<%= post.title %>"></a>
			    <div class="card-body">
			      <h4 class="card-title">
			        <a href="/posts/<%= post.id %>"><%= post.title %></a>
			      </h4>
			      <h5>$<%= post.price %>.00</h5>
			      <p class="card-text"><%- post.description.substring(0, 20) %><%= post.description.length > 20 ? '...' : '' %></p>
			      <a href="/posts/<%= post.id %>" class="btn btn-outline-primary">View Board</a>
			    </div>
			    <div class="card-footer">
			      <small class="text-muted"><%= post.condition %></small>
			    </div>
			  </div>
			</div>
			<% }); %>
		</div>
		<% if (paginate.hasPreviousPages || paginate.hasNextPages(pageCount)) { %>
		<div class="row justify-content-center">
			<div class="col-4">		
				<nav aria-label="Page navigation">
					<ul class="pagination justify-content-center">
						<% if (paginate.hasPreviousPages) { %>
						<li class="page-item">
							<a href="<%= paginate.href(true) %>" class="page-link" aria-label="Previous">
								<span aria-hidden="true">&laquo;</span>
							</a>
						</li>
						<% } %>
						<% if (pages) { %>
						<% pages.forEach(function(page) { %>
						<li class="page-item <% if(page.number === pageNumber) { %>active<% } %>"><a href="<%= page.url %>" class="page-link"><%= page.number %></a></li>
						<% }); %>
						<% } %>
						<% if (paginate.hasNextPages(pageCount)) { %>
						<li class="page-item">
							<a href="<%= paginate.href() %>" class="page-link" aria-label="Next">
								<span aria-hidden="true">&raquo;</span>
							</a>
						</li>
						<% } %>
					</ul>
				</nav>
			</div>
			<!-- /.col-3 -->
		</div>
		<!-- /.row -->
		<% } %>
  </div>
  <!-- /.col-lg-9 -->

</div>
<!-- /.row -->

<script>
	var posts = <%- JSON.stringify(posts) %>;
</script>